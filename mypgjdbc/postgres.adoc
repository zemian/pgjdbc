
= Other PostgreSQL tips

== Setup quick db for pgbench tool

https://wiki.postgresql.org/wiki/Pgbenchtesting
https://www.postgresql.org/docs/9.6/static/pgbench.html

bin\createuser zemian
bin\createdb -O zemian zemian
bin\pgbench -U zemian -i zemian
bin\pgbench -c 4 -j 2 -T 600 zemian


== Getl all tables and row counts
SELECT relname, n_live_tup FROM pg_stat_user_tables ORDER BY n_live_tup DESC;

== Enable SQL queries monitoring
:hp-tags: postgres

1. Edit postgresql.conf with the following
----
# Enable extension
shared_preload_libraries = 'pg_stat_statements'

# Increase the max size of the query strings Postgres records
track_activity_query_size = 2048

# Track statements generated by stored procedures as well
pg_stat_statements.track = all
----

2. Restart PostgreSQL server

3. Connect to your database
mydb# CREATE EXTENSION pg_stat_statements;
mydb# SELECT * FROM pg_stat_statements;

ref: https://pganalyze.com/docs/install/01_enabling_pg_stat_statements


= How to generate UUID string
:hp-tags: postgres

----
psql> \c mydb;
mydb=# CREATE EXTENSION "pgcrypto"
mydb-# ;
CREATE EXTENSION
mydb=# select gen_random_uuid();
           gen_random_uuid
--------------------------------------
 899d664c-f80f-4b4d-b176-900d6e26feed
(1 row)
----